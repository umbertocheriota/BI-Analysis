Which cities have more than 1 airport?

with new_clm as ( --создаём оконную функцию для нумерации строк по городам и дальнейшего их подсчёта
	select *, row_number() over (partition by city) --нумеруем строки по названию города
	from airports
)
select city, count(row_number) -- выбираем город и количество строк
from new_clm
group by city
having count(row_number) > 1; --группируем по названию города и выделяем только города с количеством строк с нумерацией больше 1 по каждому городу
